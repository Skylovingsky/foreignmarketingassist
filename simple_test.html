<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç®€å•APIæµ‹è¯•</title>
</head>
<body>
    <h1>APIæµ‹è¯•é¡µé¢</h1>
    <p>è¯·æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º</p>
    
    <button onclick="testAll()">å¼€å§‹æµ‹è¯•</button>
    <div id="status"></div>

    <script>
        const API_BASE = 'https://3001-ibr8pve55krqf22np4xrh-6532622b.e2b.dev';
        
        async function testAll() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<p>æµ‹è¯•å¼€å§‹ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°...</p>';
            
            console.log('ğŸš€ å¼€å§‹APIæµ‹è¯•');
            console.log('API Base URL:', API_BASE);
            
            // Test 1: Health Check
            try {
                console.log('ğŸ“Š æµ‹è¯•1: å¥åº·æ£€æŸ¥');
                const healthResponse = await fetch(`${API_BASE}/api/agent/health`);
                console.log('å¥åº·æ£€æŸ¥å“åº”çŠ¶æ€:', healthResponse.status);
                console.log('å¥åº·æ£€æŸ¥å“åº”å¤´:', Object.fromEntries(healthResponse.headers.entries()));
                const healthData = await healthResponse.json();
                console.log('å¥åº·æ£€æŸ¥æ•°æ®:', healthData);
                statusDiv.innerHTML += '<p>âœ… å¥åº·æ£€æŸ¥é€šè¿‡</p>';
            } catch (error) {
                console.error('âŒ å¥åº·æ£€æŸ¥å¤±è´¥:', error);
                statusDiv.innerHTML += '<p>âŒ å¥åº·æ£€æŸ¥å¤±è´¥: ' + error.message + '</p>';
            }
            
            // Test 2: Get Customers
            try {
                console.log('ğŸ“‹ æµ‹è¯•2: è·å–å®¢æˆ·åˆ—è¡¨');
                const customersResponse = await fetch(`${API_BASE}/api/customers`);
                console.log('å®¢æˆ·åˆ—è¡¨å“åº”çŠ¶æ€:', customersResponse.status);
                console.log('å®¢æˆ·åˆ—è¡¨å“åº”å¤´:', Object.fromEntries(customersResponse.headers.entries()));
                const customersData = await customersResponse.json();
                console.log('å®¢æˆ·åˆ—è¡¨æ•°æ®:', customersData);
                statusDiv.innerHTML += '<p>âœ… è·å–å®¢æˆ·åˆ—è¡¨æˆåŠŸ</p>';
            } catch (error) {
                console.error('âŒ è·å–å®¢æˆ·åˆ—è¡¨å¤±è´¥:', error);
                statusDiv.innerHTML += '<p>âŒ è·å–å®¢æˆ·åˆ—è¡¨å¤±è´¥: ' + error.message + '</p>';
            }
            
            // Test 3: Create Customer
            try {
                console.log('ğŸ‘¥ æµ‹è¯•3: åˆ›å»ºå®¢æˆ·');
                const timestamp = Date.now();
                const customerData = {
                    companyName: 'Simple Test Company',
                    contactName: 'Test Contact Person',
                    email: `simple${timestamp}@test.com`, // ä½¿ç”¨æ—¶é—´æˆ³ç¡®ä¿é‚®ç®±å”¯ä¸€
                    country: 'Test Country',
                    industry: 'Test Industry'
                };
                
                console.log('å‘é€å®¢æˆ·æ•°æ®:', customerData);
                
                const createResponse = await fetch(`${API_BASE}/api/customers`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerData)
                });
                
                console.log('åˆ›å»ºå®¢æˆ·å“åº”çŠ¶æ€:', createResponse.status);
                console.log('åˆ›å»ºå®¢æˆ·å“åº”å¤´:', Object.fromEntries(createResponse.headers.entries()));
                
                if (createResponse.ok) {
                    const createData = await createResponse.json();
                    console.log('åˆ›å»ºå®¢æˆ·æˆåŠŸæ•°æ®:', createData);
                    statusDiv.innerHTML += '<p>âœ… åˆ›å»ºå®¢æˆ·æˆåŠŸ</p>';
                } else {
                    const errorData = await createResponse.text();
                    console.error('åˆ›å»ºå®¢æˆ·å¤±è´¥å“åº”:', errorData);
                    statusDiv.innerHTML += '<p>âŒ åˆ›å»ºå®¢æˆ·å¤±è´¥: ' + createResponse.status + ' - ' + errorData + '</p>';
                }
            } catch (error) {
                console.error('âŒ åˆ›å»ºå®¢æˆ·ç½‘ç»œé”™è¯¯:', error);
                statusDiv.innerHTML += '<p>âŒ åˆ›å»ºå®¢æˆ·ç½‘ç»œé”™è¯¯: ' + error.message + '</p>';
            }
            
            console.log('ğŸ APIæµ‹è¯•å®Œæˆ');
            statusDiv.innerHTML += '<p>ğŸ æµ‹è¯•å®Œæˆï¼Œè¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹æ§åˆ¶å°</p>';
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
        window.addEventListener('load', () => {
            console.log('ğŸŒ ç¯å¢ƒä¿¡æ¯:');
            console.log('é¡µé¢URL:', window.location.href);
            console.log('ç”¨æˆ·ä»£ç†:', navigator.userAgent);
            console.log('APIåŸºç¡€URL:', API_BASE);
        });
    </script>
</body>
</html>